<MudMenu AnchorOrigin="Origin.BottomCenter" TransformOrigin="Origin.TopCenter" Dense="true" Class="d-inline-block">
    <ActivatorContent>
        <MudAvatar Size="Size.Medium" Style="width:30px; height:40px; cursor: pointer;">
            <MudImage Src="@((string.IsNullOrWhiteSpace(ProfileImage) ? "../images/profile/user.png" : ProfileImage))"></MudImage>
        </MudAvatar>
    </ActivatorContent>
    <ChildContent>
        <MudPaper Class="pa-2" Style="width: 150px; font-family: Tahoma;">
            <MudList T="string" Dense="true">
                <MudListItem>
                    <MudText Class="text-primary fw-bold" Style="cursor:pointer;">
                        <MudIcon Icon="@Icons.Material.Filled.ManageAccounts" Class="me-1" />
                        Profile
                    </MudText>
                </MudListItem>
            </MudList>
            <MudDivider Class="my-2" />
            <MudButton Color="Color.Error" Variant="Variant.Filled" FullWidth="true" OnClick="LogoutClicked" Size="Size.Small" Class="fw-bold">
                <MudIcon Icon="@Icons.Material.Filled.Logout" Class="me-1" />
                Logout
            </MudButton>
        </MudPaper>
    </ChildContent>
</MudMenu>

@code
{
    public string ProfileImage { get; set; } = "";

    async Task LogoutClicked()
    {
        var logoutModel = new UserSession();
        var customAuthStateProvider = (CustomAuthenticationStateProvider)AuthStateProvider;
        await customAuthStateProvider.UpdateAuthenticationState(logoutModel);
        NavManager.NavigateTo("/identity/account/login", replace: true, forceLoad: true);
    }

}
